<div class="premium-content-management">
  <div class="header">
    <h2>Premium Content Management</h2>
    <p>Create and manage premium video content to monetize your videos</p>
  </div>

  <mat-tab-group [(selectedIndex)]="activeTab" (selectedIndexChange)="onTabChange($event)">
    
    <!-- Create Premium Video Tab -->
    <mat-tab label="Create Premium Video">
      <div class="tab-content">
        <mat-card class="form-card">
          <mat-card-header>
            <mat-card-title>Create Premium Video</mat-card-title>
            <mat-card-subtitle>Convert your videos to premium content</mat-card-subtitle>
          </mat-card-header>
          
          <mat-card-content>
            <form [formGroup]="premiumVideoForm" (ngSubmit)="onSubmit()" class="premium-form">
              <div class="form-row">
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>Select Video</mat-label>
                  <mat-select formControlName="videoId" required>
                    <mat-option *ngFor="let video of availableVideos" [value]="video.id">
                      {{ video.title }}
                    </mat-option>
                  </mat-select>
                  <mat-error *ngIf="premiumVideoForm.get('videoId')?.hasError('required')">
                    Please select a video
                  </mat-error>
                </mat-form-field>
              </div>

              <div class="form-row">
                <mat-form-field appearance="outline" class="half-width">
                  <mat-label>Price</mat-label>
                  <input matInput type="number" formControlName="price" placeholder="0.00" step="0.01" min="0.01">
                  <span matPrefix>$&nbsp;</span>
                  <mat-error *ngIf="premiumVideoForm.get('price')?.hasError('required')">
                    Price is required
                  </mat-error>
                  <mat-error *ngIf="premiumVideoForm.get('price')?.hasError('min')">
                    Price must be at least $0.01
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="half-width">
                  <mat-label>Currency</mat-label>
                  <mat-select formControlName="currency">
                    <mat-option value="USD">USD</mat-option>
                    <mat-option value="EUR">EUR</mat-option>
                    <mat-option value="GBP">GBP</mat-option>
                    <mat-option value="CAD">CAD</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>

              <div class="form-actions">
                <button mat-raised-button color="primary" type="submit" [disabled]="premiumVideoForm.invalid || loading">
                  <mat-icon>add</mat-icon>
                  Create Premium Video
                </button>
              </div>
            </form>
          </mat-card-content>
        </mat-card>
      </div>
    </mat-tab>

    <!-- Manage Premium Videos Tab -->
    <mat-tab label="My Premium Videos">
      <div class="tab-content">
        <div class="section-header">
          <h3>My Premium Videos</h3>
          <p>Manage your premium video content</p>
        </div>

        <div class="premium-videos-list" *ngIf="premiumVideos.length > 0; else noPremiumVideos">
          <mat-card *ngFor="let premiumVideo of premiumVideos" class="premium-video-card">
            <mat-card-content>
              <div class="video-info">
                <div class="video-thumbnail">
                  <img [src]="premiumVideo.videoThumbnailUrl" [alt]="premiumVideo.videoTitle" class="thumbnail">
                </div>
                <div class="video-details">
                  <h4>{{ premiumVideo.videoTitle }}</h4>
                  <p class="creator">by {{ premiumVideo.creatorName }}</p>
                  <div class="price-info">
                    <span class="price">{{ premiumVideo.price | currency:premiumVideo.currency:'symbol':'1.2-2' }}</span>
                    <span class="currency">{{ premiumVideo.currency }}</span>
                  </div>
                  <div class="status-info">
                    <span class="status" [class.active]="premiumVideo.isActive" [class.inactive]="!premiumVideo.isActive">
                      {{ premiumVideo.isActive ? 'Active' : 'Inactive' }}
                    </span>
                    <span class="created-date">{{ premiumVideo.createdAt | date:'short' }}</span>
                  </div>
                </div>
              </div>
              
              <div class="video-actions">
                <button mat-icon-button (click)="toggleActive(premiumVideo)" [color]="premiumVideo.isActive ? 'warn' : 'primary'">
                  <mat-icon>{{ premiumVideo.isActive ? 'pause' : 'play_arrow' }}</mat-icon>
                </button>
                <button mat-icon-button (click)="selectPremiumVideo(premiumVideo)" color="primary">
                  <mat-icon>analytics</mat-icon>
                </button>
                <button mat-icon-button (click)="deletePremiumVideo(premiumVideo.id)" color="warn">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </mat-card-content>
          </mat-card>
        </div>

        <ng-template #noPremiumVideos>
          <div class="no-content">
            <mat-icon>video_library</mat-icon>
            <h3>No Premium Videos</h3>
            <p>You haven't created any premium videos yet. Create your first premium video to start monetizing your content.</p>
            <button mat-raised-button color="primary" (click)="activeTab = 0">
              <mat-icon>add</mat-icon>
              Create Premium Video
            </button>
          </div>
        </ng-template>

        <!-- Pagination -->
        <mat-paginator 
          *ngIf="totalCount > pageSize"
          [length]="totalCount"
          [pageSize]="pageSize"
          [pageIndex]="currentPage - 1"
          [pageSizeOptions]="[5, 10, 25, 50]"
          (page)="onPageChange($event)"
          showFirstLastButtons>
        </mat-paginator>
      </div>
    </mat-tab>

    <!-- Analytics Tab -->
    <mat-tab label="Analytics">
      <div class="tab-content">
        <div class="section-header">
          <h3>Premium Content Analytics</h3>
          <p *ngIf="selectedPremiumVideo">Analytics for: {{ selectedPremiumVideo.videoTitle }}</p>
        </div>

        <div *ngIf="analytics; else noAnalytics" class="analytics-content">
          <div class="analytics-grid">
            <mat-card class="analytics-card">
              <mat-card-content>
                <div class="metric">
                  <div class="metric-value">{{ analytics.totalPurchases }}</div>
                  <div class="metric-label">Total Purchases</div>
                </div>
              </mat-card-content>
            </mat-card>

            <mat-card class="analytics-card">
              <mat-card-content>
                <div class="metric">
                  <div class="metric-value">{{ analytics.totalRevenue | currency:'USD':'symbol':'1.2-2' }}</div>
                  <div class="metric-label">Total Revenue</div>
                </div>
              </mat-card-content>
            </mat-card>

            <mat-card class="analytics-card">
              <mat-card-content>
                <div class="metric">
                  <div class="metric-value">{{ analytics.averagePrice | currency:'USD':'symbol':'1.2-2' }}</div>
                  <div class="metric-label">Average Price</div>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
        </div>

        <ng-template #noAnalytics>
          <div class="no-content">
            <mat-icon>analytics</mat-icon>
            <h3>No Analytics Available</h3>
            <p>Select a premium video to view its analytics.</p>
          </div>
        </ng-template>
      </div>
    </mat-tab>

    <!-- My Purchases Tab -->
    <mat-tab label="My Purchases">
      <div class="tab-content">
        <div class="section-header">
          <h3>My Premium Purchases</h3>
          <p>View your premium content purchases</p>
        </div>

        <div class="purchases-list" *ngIf="purchases.length > 0; else noPurchases">
          <mat-card *ngFor="let purchase of purchases" class="purchase-card">
            <mat-card-content>
              <div class="purchase-info">
                <div class="purchase-details">
                  <h4>{{ purchase.videoTitle }}</h4>
                  <div class="purchase-meta">
                    <span class="amount">{{ purchase.amount | currency:purchase.currency:'symbol':'1.2-2' }}</span>
                    <span class="status" [style.color]="getStatusColor(purchase.status)">
                      {{ purchase.status }}
                    </span>
                    <span class="date">{{ purchase.purchasedAt | date:'short' }}</span>
                  </div>
                </div>
                <div class="purchase-actions">
                  <button mat-button color="primary" *ngIf="purchase.status === 'Completed'">
                    <mat-icon>play_arrow</mat-icon>
                    Watch
                  </button>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>

        <ng-template #noPurchases>
          <div class="no-content">
            <mat-icon>shopping_cart</mat-icon>
            <h3>No Purchases Yet</h3>
            <p>You haven't purchased any premium content yet.</p>
          </div>
        </ng-template>
      </div>
    </mat-tab>

  </mat-tab-group>
</div>
